;---------
;AUTHOR: BHISHMA DEDHIA
;NAME: PACK AND READ NIBBLES
;---------
ORG 0H
LJMP MAIN
;---------
ORG 50H
	DELAY: 
	SETB PSW.5
		   MOV R3, 40H
	BACK3: 
		   MOV R4, #10
	BACK2:	   
		   MOV R5,#200
	BACK1:
		   MOV R1,#0FFH
	BACK:
		   DJNZ R1, BACK
		   DJNZ R5, BACK1
		   DJNZ R4, BACK2
		   DJNZ R3, BACK3
		   CLR PSW.5
	   RET
;--------
	READIP:
	MOV A,P1
	ANL A,#0FH
	MOV @R0,A
	SWAP A
	ORL A,#0FH
	MOV P1,A	
	RET
;--------	
	READNIBBLE:
	MOV R0,60H
	MOV 40H,#10
	MOV P1,#0FFH
	LCALL DELAY
	MOV P1,#0FH
	MOV 40H,#2
	LCALL DELAY
	LCALL READIP
	MOV 40H,#10
	LCALL DELAY
	;MOV P1,#0FH
	MOV A,P1
	ANL A,#0FH
	CJNE A,#0FH,READNIBBLE
	RET
;--------	
	PACKNIBBLE:
	MOV A,4EH
	SWAP A
	ADD A,4FH
	MOV 50H,A
	RET
;--------
	MAIN:
	MOV 60H,#4EH
	LCALL READNIBBLE
	MOV 60H,#4FH
	LCALL READNIBBLE
	LCALL PACKNIBBLE
	MOV 40H,#2
	MOV A,4EH
	SWAP A
	MOV P1,A
	LCALL DELAY
	MOV A,4FH
	SWAP A
	MOV P1,A
	LCALL DELAY
	MOV P1,#00H
	HERE: SJMP HERE
	
	
	END
	
	